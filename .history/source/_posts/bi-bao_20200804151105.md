---
title: 闭包，老铁安排上
date: 2020-06-09 11:46:06
tags: 闭包
categories: 前端
---

呱呱，啥是闭包？
天天写闭包，但是让表达出来，还真有点懵住了，
这玩意我都记在心里，话说不出口，都在酒里了，干杯～

---### 闭包是啥？

来几个官方回答，可以应付面试

- 闭包是一个有自己环境的函数，并且在该环境中至少有一个变量。
- 闭包是将函数与其引用的周边状态绑定在一起形成（封装）的组合
- 闭包函数是声明在一个函数中的函数
- 闭包是内部函数总是可以访问其所在的外部函数中生命的参数和变量，即使在其外部函数被返回以后

### 闭包特点（优缺点都有哈）

- 让外部访问函数内部变量成为可能；

- 局部变量会常驻在内存中；

- 可以避免使用全局变量，防止全局变量污染；(不用担心变量名重复，不过都 2020 年了，谁还频繁用 var 声明变量啊。)

- 会造成内存泄漏（有一块内存空间被长期占用，而不被释放）

  闭包就是可以创建一个独立的环境，每个闭包里面的环境都是独立的，互不干扰。**每次外部函数执行的时候，外部函数的引用地址不同，都会重新创建一个新的地址。**但凡是当前活动对象中有被内部子集引用的数据，那么这个时候，这个数据不删除，保留一根指针给内部活动对象。所以啊，当有很多很多闭包的时候，或者闭包被调用很多很多次的时候，那么就会内存泄漏了。

_然后面试的时候，可能会遇见一些笔试题，面试官整一个函数，让你写输出的值，设计个圈套坑你，怎么办？不慌！有秘诀～_

**秘诀在此：输出的就是同一个地址中的爸爸函数中的变量值**

如此简单粗暴的秘诀，喜欢吗？

光说不练假把式，下面我来表演绝活：举个栗子 🌰

```
function funA(){
  var a = 10;  // funA的活动对象之中;
  return function(){   //匿名函数的活动对象;
        alert(a);
  }
}
var b = funA();
b();

// 10
```

由浅入深，先从这个简单的开始，套入秘诀，_同一个地址中的爸爸函数中的变量值_ 啥叫同一个地址呢，就是被同一个人调用，在这个栗子里面，就是这个：

var b = funA（）
b()

这个 b 就是个地址，如果多一个 var c = funA（） 然后调用 c（），那么这个 c 就是另一个地址。

地址就明白了吧～
然后找爸爸，爸爸的爸爸叫什么，爸爸的的爸爸叫爷爷。。。哈哈 ，皮一下

回到找爹的正事上来，alert（a）是儿子，他爸在外边包住了它，就是这个 funA 是它爸。也可以理解为怀孕的母亲，和肚子里的孩子。（谁在里面谁儿子）

所以找到了它爸爸里面的变量 a=10 ，所以输出 10

好的，很开心，我们看下一个栗子 🌰

```
function zhujunFn(){
  var i = 0;
  function xcolaFn(){
      i++;
      console.log(i);
  }
  return xcolaFn;
}
var aaa = zhujunFn();  //每次外部函数执行的时候,外部函数的地址不同，都会重新创建一个新的地址,这个aaa是个新的地址
aaa();
aaa();
aaa();
var bbb = zhujunFn();  //  所以这也是一个新的地址，aaa和bbb 是两个不同的地址
bbb();
bbb();
bbb();

// 1 2 3 1 2 3
```

先重复一下我们的秘诀，然后找爹

- _同一个地址中的爸爸函数中的变量值_

  aaa 和 bbb 分别是两个地址，是独立的

  然后给这个 **xcolaFn** 找爹，是外边这个 **zhujunFn**，然后找到里面的这个变量 i，每次调用 aaa（）输出 i 为 1，2，3

  每次调用 bbb（）是新的地址，独立的，所以也是一样的道理 输出 i 为 1，2，3

```
for (var i=1; i<=5; i++) { (function(j) {
setTimeout( function timer() { console.log( j );
             }, j*1000 );
         })( i );
}
```

## 总结

我没啥想总结了，有营养的都在上边了，如果看完了发现还是不太明白，那一定是我没说清楚，不怪你，那就再看看这个人对闭包的理解吧，会有帮助的
链接在此：[请点击这里](http://blog.xcola.top/2018/05/23/%E5%AF%B9%E9%97%AD%E5%8C%85%E7%9A%84%E7%90%86%E8%A7%A3/)

**冲鸭，奥利给**
